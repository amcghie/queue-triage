java_library(
    name = "queue-triage-core-activemq",
    srcs = glob(["src/main/java/**/*.java"]),
    deps = [
        "//common/cxf:queue-triage-common-cxf",
        "//common/executor:queue-triage-common-executor",
        "//core/domain:queue-triage-core-domain",
        "//core/jms:queue-triage-core-jms",
        "//core/jms:queue-triage-core-jms-spring",
        "//core/service:queue-triage-core-service",
        "//lib/activemq:activemq-client",
        "//lib/activemq:geronimo-jms",
        "//lib/javax:javax-ws-rs-api",
        "//lib/slf4j:slf4j-api",
        "//lib/spring:spring-beans",
        "//lib/spring:spring-boot",
        "//lib/spring:spring-boot-autoconfigure",
        "//lib/spring:spring-context",
        "//lib/spring:spring-core",
        "//lib/spring:spring-jms",
        "//lib/swagger:swagger-annotations",
    ],
    visibility = [
        "//core/component-test:queue-triage-core-component-test",
        "//core/component-test:test",
        "//core/resend:queue-triage-core-resend-spring",
        "//core/resend:test-spring",
        "//core/server:server",
        "//core/server:test",
    ]
)

java_library(
    name = "test-resources",
    resources = [
        "src/test/resources/single-broker.yml",
        "src/test/resources/single-broker-read-only.yml",
        "src/test/resources/multiple-brokers.yml",
        "src/test/resources/multiple-brokers-one-read-only.yml",
    ],
    resources_root = "src/test/resources",
    visibility = [
        "//core/activemq:test",
    ],
)

java_test(
    name = "test",
    srcs = glob([ "src/test/java/**/*.java" ]),
    deps = [
        ":test-resources",
        ":queue-triage-core-activemq",
        "//common/executor:queue-triage-common-executor",
        "//core/domain:queue-triage-core-domain",
        "//core/domain-test-support:queue-triage-core-domain-test-support",
        "//core/jms:queue-triage-core-jms",
        "//core/jms:queue-triage-core-jms-spring",
        "//core/service:queue-triage-core-service",
        "//lib/activemq:activemq-client-with-dependencies",
        "//lib:commons-lang3",
        "//lib/javax:javax-ws-rs-api",
        "//lib/slf4j:slf4j-api",
        "//lib:snakeyaml",
        "//lib/spring:spring-core",
        "//lib/spring:spring-core-dependencies",
        "//lib/spring:spring-jms",
        "//lib/spring:spring-test",
        "//lib/spring:spring-tx",
        "//lib/test:common",
    ],
)